name: markdown-link-check
on:
  push:
jobs:
  markdown-link-check:
    name: Check markdown files
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Markdown links check
        uses: ruzickap/action-my-markdown-link-checker@v1
  run-if-failed:
    runs-on: ubuntu-latest
    needs: [markdown-link-check]
    if: always() && (needs.markdown-link-check.result == 'failure')
    steps:
      # email sender
      - name: Send email
      - uses: devellany/send-mailer@v1.0.2
        with:
          host: smtp.google.com
          account: ${{secrets.ACCOUNT}}
          password: ${{secrets.MAIL_PASSWORD}}
          sender: devellany
          from: ${{secrets.MAIL_ADDRESS}}
          to: chris.kottisse@khk.ee
          subject: Kassivad kassid
          body: file://kassid.txt
          contentType: text/html
          # Optional attachment files (JSON type. require property 'path')
          attachments: '[{"path":"kassid.txt"}]'